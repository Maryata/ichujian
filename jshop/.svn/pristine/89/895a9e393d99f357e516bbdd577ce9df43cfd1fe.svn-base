package net.jeeshop.services.manage.sms.impl;import javax.annotation.Resource;import net.jeeshop.core.ServersManager;import net.jeeshop.core.sms.SMSUtil;import net.jeeshop.core.util.ApDateTime;import net.jeeshop.services.manage.sms.SmsService;import net.jeeshop.services.manage.sms.bean.Sms;import net.jeeshop.services.manage.sms.bean.SmsValidate;import net.jeeshop.services.manage.sms.dao.SmsDao;import net.jeeshop.services.manage.sms.dao.SmsValidateDao;import org.springframework.stereotype.Service;@Service("smsServiceManage")public class SmsServiceImpl extends ServersManager<Sms, SmsDao> implements SmsService {    @Resource(name = "smsDaoManage")    @Override    public void setDao(SmsDao smsDao) {        this.dao = smsDao;    }        @Resource(name="smsValidateDaoManage")    private SmsValidateDao smsValidateDao;	@Override	public boolean saveValidateMsg(Sms sms, SmsValidate smsValidate) throws Exception {		//发送短信		SMSUtil.sendSMS(sms);				sms.setSendTime(ApDateTime.getNowDateTime(ApDateTime.DATE_TIME_SSS));				//设置之前的验证码为无效		SmsValidate sv = new SmsValidate();		sv.setType(smsValidate.getType());		sv.setPhone(smsValidate.getPhone());		this.smsValidateDao.update(sv);				//保存新的验证码		smsValidate.setVtime(sms.getSendTime());				this.smsValidateDao.insert(smsValidate);		//保存发送的短信		this.dao.insert(sms);				return true;	}		@Override	public boolean saveMsg(Sms sms){		//发送短信		try {			SMSUtil.sendSMS(sms);			sms.setSendTime(ApDateTime.getNowDateTime(ApDateTime.DATE_TIME_SSS));						//保存发送的短信			this.dao.insert(sms);						return true;		} catch (Exception e) {			log.error("send msg faild", e);			return false;		}	}	@Override	public int getIsValidate(SmsValidate smsValidate) {		return this.smsValidateDao.getCount(smsValidate) ;	}            }